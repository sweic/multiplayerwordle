{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { VALIDGUESSES, WORDS } from \"../constants\";\nimport React, { useState } from 'react';\nimport { useStateRef } from \"../hooks\";\nexport const useGameStatus = () => {\n  _s();\n\n  const [error, setError] = useState(false);\n  const [winner, setWinner] = useState(null);\n  const [rematch, setRematch] = useState(false);\n\n  const checkKey = (e, wordle, client, clientID, gameID, user, historyRef, setHistory, currentRowRef, setCurrentRow, gameStatusRef) => {\n    if (historyRef.current.length == 6 || gameStatusRef.current) return;\n\n    if (currentRowRef.current.length == 5) {\n      if (e.keyCode == 13) {\n        var word = currentRowRef.current;\n\n        if (!VALIDGUESSES.includes(word.join('')) && !WORDS.includes(word.join(''))) {\n          setError(true);\n          setTimeout(() => {\n            setError(false);\n          }, 2000);\n          return;\n        }\n\n        var target = wordle;\n        const final = computeGuess(currentRowRef.current, wordle);\n        setHistory([...historyRef.current, final]);\n        setCurrentRow([]);\n        client.send(JSON.stringify({\n          type: \"update\",\n          payload: {\n            rows: historyRef.current,\n            clientID: clientID,\n            gameID: gameID\n          }\n        }));\n\n        if (final.every(value => value.status == \"green\")) {\n          const data = {\n            type: \"winner\",\n            payload: {\n              winner: user,\n              gameID: gameID\n            }\n          };\n          client.send(JSON.stringify(data));\n          setWinner(true);\n          setRematch(true);\n          return;\n        }\n\n        if (historyRef.current.length == 6) {\n          const data = {\n            type: \"max\",\n            payload: {\n              gameID: gameID\n            }\n          };\n          client.send(JSON.stringify(data));\n        }\n      } else if (e.keyCode == 8) {\n        const tmp = currentRowRef.current.slice(0, currentRowRef.current.length - 1);\n        setCurrentRow(tmp);\n      }\n    } else if (e.keyCode == 8) {\n      const tmp = currentRowRef.current.slice(0, currentRowRef.current.length - 1);\n      setCurrentRow(tmp);\n    } else if (currentRowRef.current.length < 5) {\n      if (e.keyCode >= 65 && e.keyCode <= 90) {\n        setCurrentRow([...currentRowRef.current, e.key]);\n      }\n    }\n  };\n\n  const resetKeys = dirtyKeys => {\n    for (var i of Object.keys(dirtyKeys)) {\n      dirtyKeys[i].status = \"none\";\n    }\n\n    return dirtyKeys;\n  };\n\n  const colourKeys = initKeysOne => {\n    const idx = history.length - 1;\n\n    for (var i in history[idx]) {\n      const targetKey = history[idx][i].key;\n      if (initKeysOne[targetKey].status == \"green\") continue;\n      if (initKeysOne[targetKey].status == \"yellow\" && history[idx][i].status == \"gray\") continue;\n      initKeysOne[targetKey].status = history[idx][i].status;\n    }\n\n    return initKeysOne;\n  };\n\n  const computeGuess = (guess, wordle) => {\n    var target = wordle.split('');\n    var letters = guess;\n    var final = Array(target.length);\n    var unchecked = Array(target.length).fill(0);\n\n    for (var i in letters) {\n      if (letters[i] == target[i]) {\n        final[i] = {\n          key: letters[i],\n          status: \"green\"\n        };\n        unchecked[i] = 1;\n        target[i] = null;\n        letters[i] = null;\n      }\n    }\n\n    for (var j in letters) {\n      if (letters[j] == null) continue;\n\n      if (target.includes(letters[j])) {\n        final[j] = {\n          key: letters[j],\n          status: \"yellow\"\n        };\n        unchecked[j] = 1;\n        const idx = target.indexOf(letters[j]);\n        target[idx] = null;\n        letters[j] = null;\n      }\n    }\n\n    for (var k in unchecked) {\n      if (unchecked[k] == 0) {\n        final[k] = {\n          key: letters[k],\n          status: \"gray\"\n        };\n      }\n    }\n\n    return final;\n  };\n};\n\n_s(useGameStatus, \"SemB3tOtPqiF5Emiln/t6KMP9c8=\");","map":{"version":3,"sources":["C:/Users/ytdan/OneDrive/Desktop/Computer Science/MERN/wordle-io/client/src/functions/handler.js"],"names":["VALIDGUESSES","WORDS","React","useState","useStateRef","useGameStatus","error","setError","winner","setWinner","rematch","setRematch","checkKey","e","wordle","client","clientID","gameID","user","historyRef","setHistory","currentRowRef","setCurrentRow","gameStatusRef","current","length","keyCode","word","includes","join","setTimeout","target","final","computeGuess","send","JSON","stringify","type","payload","rows","every","value","status","data","tmp","slice","key","resetKeys","dirtyKeys","i","Object","keys","colourKeys","initKeysOne","idx","history","targetKey","guess","split","letters","Array","unchecked","fill","j","indexOf","k"],"mappings":"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","sourcesContent":["import { VALIDGUESSES, WORDS } from \"../constants\";\r\nimport React, {useState} from 'react'\r\nimport { useStateRef } from \"../hooks\";\r\nexport const useGameStatus = () => {\r\n   \r\n    const [error, setError] = useState(false)\r\n    const [winner, setWinner] = useState(null);\r\n    const [rematch, setRematch] = useState(false);\r\n\r\n    const checkKey = (e, wordle, client, clientID, gameID, user, historyRef, setHistory, currentRowRef, setCurrentRow, gameStatusRef)  => {\r\n        if (historyRef.current.length == 6 || gameStatusRef.current ) return;\r\n    \r\n      \r\n        if (currentRowRef.current.length == 5) {\r\n            \r\n            if (e.keyCode == 13) {\r\n               \r\n                var word = currentRowRef.current\r\n                if (!VALIDGUESSES.includes(word.join('')) && !WORDS.includes(word.join(''))) {\r\n                    setError(true);\r\n                    setTimeout(() => {\r\n                        setError(false)\r\n                    }, 2000)\r\n                    return \r\n                }\r\n           var target = wordle;\r\n           const final = computeGuess(currentRowRef.current, wordle);\r\n           setHistory([...historyRef.current, final])\r\n           setCurrentRow([])\r\n         \r\n           client.send(JSON.stringify({type: \"update\", payload: {rows: historyRef.current, clientID: clientID, gameID: gameID}}));\r\n           if (final.every((value) => value.status == \"green\")) {\r\n            const data = {\r\n                type: \"winner\",\r\n                payload: {\r\n                    winner: user,\r\n                    gameID: gameID\r\n                    }\r\n            }\r\n            client.send(JSON.stringify(data));\r\n            setWinner(true);\r\n            setRematch(true);\r\n            return;\r\n         }\r\n         if (historyRef.current.length == 6) {\r\n             const data = {\r\n                 type:\"max\",\r\n                 payload: {gameID: gameID}\r\n             }\r\n    \r\n             client.send(JSON.stringify(data));\r\n             \r\n         }\r\n            } \r\n            else if (e.keyCode == 8) {\r\n                const tmp = currentRowRef.current.slice(0, currentRowRef.current.length - 1)\r\n                setCurrentRow(tmp)\r\n            }\r\n        } else if (e.keyCode == 8) {\r\n            const tmp = currentRowRef.current.slice(0, currentRowRef.current.length - 1)\r\n            setCurrentRow(tmp)\r\n        } else if (currentRowRef.current.length < 5) {\r\n            if (e.keyCode >= 65 && e.keyCode <= 90) {\r\n                setCurrentRow([...currentRowRef.current, e.key])\r\n            }\r\n    \r\n        }\r\n        \r\n    }\r\n\r\n\r\n    const resetKeys = (dirtyKeys) => {\r\n        for (var i of Object.keys(dirtyKeys)) {\r\n            dirtyKeys[i].status = \"none\";\r\n        }\r\n        return dirtyKeys;\r\n    }\r\n\r\n     \r\n    const colourKeys = (initKeysOne) => {\r\n        const idx = history.length - 1;\r\n        for (var i in history[idx]) {\r\n            const targetKey = history[idx][i].key;\r\n            if (initKeysOne[targetKey].status == \"green\") continue;\r\n            if (initKeysOne[targetKey].status == \"yellow\" && history[idx][i].status == \"gray\") continue;\r\n            initKeysOne[targetKey].status = history[idx][i].status; \r\n        }\r\n        return initKeysOne;\r\n    }\r\n    const computeGuess = (guess, wordle) => {\r\n        var target = wordle.split('');\r\n        var letters = guess\r\n        var final = Array(target.length)\r\n        var unchecked = Array(target.length).fill(0);\r\n    \r\n\r\n\r\n        for (var i in letters) {\r\n            if (letters[i] == target[i]) {\r\n                final[i] = ({key: letters[i], status: \"green\"})\r\n                unchecked[i] = 1\r\n                target[i] = null;\r\n                letters[i] = null;\r\n                \r\n            }\r\n        }\r\n\r\n        for (var j in letters) {\r\n            if (letters[j] == null) continue;\r\n            if (target.includes(letters[j])) {\r\n                final[j] = ({key: letters[j], status: \"yellow\"})\r\n                unchecked[j] = 1;\r\n                const idx = target.indexOf(letters[j]);\r\n                target[idx] = null;\r\n                letters[j] = null;\r\n            }\r\n        }\r\n\r\n        for (var k in unchecked) {\r\n            if (unchecked[k] == 0) {\r\n                final[k] = ({key: letters[k], status: \"gray\"});\r\n            }\r\n        }\r\n    \r\n        return final;\r\n\r\n}\r\n    \r\n\r\n}\r\n\r\n\r\n"]},"metadata":{},"sourceType":"module"}